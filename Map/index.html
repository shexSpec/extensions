<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="generator" content="emacs" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <title>ShExMap</title>
    <!-- link rel="stylesheet" href="local.css" type="text/css" / -->
    <style type="text/css">
      code { background-color: #dfd; }
      .constant {
        /* font-lock-constant-face */
        color: #008b8b;
      }
      .keyword {
        /* font-lock-keyword-face */
        color: #a020f0;
      }
      .preprocessor {
        /* font-lock-preprocessor-face */
        color: #483d8b;
      }
      .string {
        /* font-lock-string-face */
        color: #8b2252;
      }
      .type {
        /* font-lock-type-face */
        color: #228b22;
      }
      .variable-name {
        /* font-lock-variable-name-face */
        color: #a0522d;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    </style>
    <style type="text/css"> <!-- SGV styles -->
      .doesnotexist {  } /* removing this disables following css (?!) */
      .cover { fill:#ffffff }

      .arc { stroke:#000000; }
      .tpl { stroke:#7f7f7f; }

      line.staticContent, polyline.staticContent { stroke:#c6c6ea; } text.staticContent { fill:#c6c6ea; }
      line.personID     , polyline.personID      { stroke:#008000; } text.personID      { fill:#008000; }
      line.personName   , polyline.personName    { stroke:#ffa500; } text.personName    { fill:#ffa500; }
      line.sysUnits     , polyline.sysUnits      { stroke:#a52a2a; } text.sysUnits      { fill:#a52a2a; }
      line.sysValue     , polyline.sysValue      { stroke:#8b6914; } text.sysValue      { fill:#8b6914; }
      line.diaUnits     , polyline.diaUnits      { stroke:#ffc0cb; } text.diaUnits      { fill:#ffc0cb; }
      line.diaValue     , polyline.diaValue      { stroke:#800080; } text.diaValue      { fill:#800080; }
                                                                     text.node          { fill:#000000; }

      #treemapArrows :not(.behind)     { fill:none; stroke-width:4 }
      #treemapArrows .behind           { fill:none; stroke-width:10 }
      #treemapArrows .arrowhead        {  }
      #treemapArrows line:not(.behind) { stroke-dasharray:5 }

      #textmapArrows { fill:none; stroke:#7f7f7f; stroke-width:4 }
      #textmapArrows .arrowhead {  }
      #textmapArrows line { stroke-dasharray:5 }

     .ll     { stroke:#7f7f7f; color: #000000; } /* font-weight: normal;  */

      .tree         { fill:none; stroke-width:2; }
      #legend       { fill:none; stroke-width:2; }

      .ll           { border: medium solid #fff; }
      .behind       { fill:none; stroke-width:6; opacity: .05; }
      .hl.behind    { opacity: .3; }
      line.behind   {  }
      .hl           { stroke:#007f00; color: #007f00; border: medium solid #777; }

      text { font-family: sans-serif; font-size: .8em; }
    </style>
    	<script src='//www.w3.org/Tools/respec/respec-w3c-common' async class='remove'></script>
	    <script class='remove'>
	      var respecConfig = {
	          specStatus: "unofficial",
	          shortName:  "shexmap",
            edDraftURI: "http://shexspec.github.io/extensions/Map/",
	          editors: [
	                {   name:       "Eric Prud'hommeaux",
	                    url:        "http://www.w3.org/People/Eric/",
	                    company:    "W3C/MIT",
	                    companyURL: "http://www.w3.org/" }
	          ],
	          wg:           "HCLS",
	          wgURI:        "https://www.w3.org/wiki/HCLSIG",
	          wgPublicList: "public-semweb-lifesci",
	          wgPatentURI:  "http://www.w3.org/2004/01/pp-impl/38539/status",
	      };
	    </script>
    <script src="../../primer/jquery.min.js" type= "text/javascript"></script>
    <script src="jquery.svg.min.js" type= "text/javascript"></script>
    <script src="jquery.svgdom.js" type= "text/javascript"></script>
    <script type="text/javascript">
      <!--
function prepareHighlight (highlightables, onClass, offClass, slide) {
  if (slide === undefined)
    slide = $("body .namespace").last();
  $.each( highlightables, function( index, value ){
    var elts = slide.find( "."+value );
    elts
  	.mouseenter(function() {
  	    elts.removeClass(offClass).addClass(onClass);
  	})
  	.mouseleave(function() {
  	    elts.removeClass(onClass).addClass(offClass);
  	})
    .addClass(offClass);
  })
}
      --> 
    </script>
    <svg version="1.1"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:cc="http://creativecommons.org/ns#"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns="http://www.w3.org/2000/svg"
         xmlns:xlink="http://www.w3.org/1999/xlink" >
      <metadata>
        <rdf:RDF>
          <cc:Work
              rdf:about="">
            <dc:format>image/svg+xml</dc:format>
            <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
          </cc:Work>
        </rdf:RDF>
      </metadata>
      <defs>
        <g id="leftText">
          <text class="node"                        x="040" y="040">:p1234567</text>
          <text class="personName"                  x="060" y="060">Patient:Аника</text>
          <text class="personID"                    x="060" y="080">PatientID:1234567</text>
          <text class="node"                        x="060" y="110">BloodPressureReading:</text>
          <text class="node"                        x="080" y="130">Systolic:</text>
          <text class="sysUnits"                    x="100" y="150">SystolicUnits:mmHg</text>
          <text class="sysValue"                    x="100" y="170">SystolicValue:110</text>
          <text class="node"                        x="080" y="190">Diastolic:</text>
          <text class="diaUnits"                    x="100" y="210">DiastolicUnits:mmHg</text>
          <text class="diaValue"                    x="100" y="230">DiastolicValue:70</text>
          <text class="node"                        x="060" y="260">BloodPressureReading:</text>
          <text class="node"                        x="080" y="280">Systolic:</text>
          <text class="sysUnits"                    x="100" y="300">SystolicUnits:mmHg</text>
          <text class="sysValue"                    x="100" y="320">SystolicValue:110</text>
          <text class="node"                        x="080" y="340">Diastolic:</text>
          <text class="diaUnits"                    x="100" y="360">DiastolicUnits:mmHg</text>
          <text class="diaValue"                    x="100" y="380">DiastolicValue:70</text>
        </g>
        <g id="textmapArrows">
          <g id="textmapArrow_p2p">
            <line                                   x1="250.593" y1="45.9086" x2="388.18799" y2="42.330101" />
            <polygon class="cover"                  points="388.679,47.3059 398.14,41.348 387.697,37.3543 " />
            <polygon                                points="388.679,47.3059 398.14,41.348 387.697,37.3543 " />
          </g>
          <g id="textmapArrow_obs1">
            <line                                   x1="250.593" y1="107.907898" x2="388.254" y2="116.927" />
            <polygon class="cover"                  points="387.57,121.88 398.16,118.296 388.938,111.974 " />
            <polygon                                points="387.57,121.88 398.16,118.296 388.938,111.974 " />
          </g>
          <g id="textmapArrow_obs2">
            <line                                   x1="250.04601" y1="259.759" x2="392.26401" y2="372.89401" />
            <polygon class="cover"                  points="389.152,376.807 400.09,379.119 395.377,368.981 " />
            <polygon                                points="389.152,376.807 400.09,379.119 395.377,368.981 " />
          </g>
        </g>
        <g id="leftTrees">
          <g id="leftPatient" class="tree">
            <line class="arc"                       x1="140" y1="400" x2="120" y2="440" />
            <line class="arc"                       x1="140" y1="400" x2="140" y2="440" />
            <line class="arc"                       x1="140" y1="400" x2="180" y2="440" />
            <g>
              <line class="personName"              x1="120" y1="440" x2="120" y2="455.52802" />
              <polyline class="personName"          points="115,447.764 120,457.764 125,447.764 " />
            </g>
            <g>
              <line class="personID"                x1="140" y1="440" x2="140" y2="455.52802" />
              <polyline class="personID"            points="135,447.764 140,457.764 145,447.764 " />
            </g>
          </g>
          <g id="leftSplit" class="tree">
            <line class="tpl"                       x1="180" y1="440" x2="160" y2="460" />
            <polyline class="tpl"                   points="165.117,447.812 161.581,458.419 172.188,454.883 " />
            <line class="tpl"                       x1="180" y1="440" x2="200" y2="460" />
            <polyline class="tpl"                   points="187.812,454.883 198.419,458.419 194.883,447.812  " />
          </g>
          <g id="leftObs1" class="tree">
            <line class="arc"                       x1="160" y1="460" x2="140" y2="500" />
            <line class="arc"                       x1="160" y1="460" x2="160" y2="500" />
            <line class="arc"                       x1="140" y1="520" x2="120" y2="560" />
            <line class="arc"                       x1="140" y1="520" x2="140" y2="560" />
            <line class="arc"                       x1="160" y1="520" x2="160" y2="560" />
            <line class="arc"                       x1="160" y1="520" x2="180" y2="560" />
            <g>
              <line class="tpl"                     x1="140" y1="500" x2="140" y2="515.52802" />
              <polyline class="tpl"                 points="135,507.764 140,517.764 145,507.764 " />
            </g>
            <g>
              <line class="tpl"                     x1="160" y1="500" x2="160" y2="515.52802" />
              <polyline class="tpl"                 points="155,507.764 160,517.764 165,507.764 " />
            </g>
            <g>
              <line class="sysUnits"                x1="120" y1="560" x2="120" y2="575.52802" />
              <polyline class="sysUnits"            points="115,567.764 120,577.764 125,567.764 " />
            </g>
            <g>
              <line class="sysValue"                x1="140" y1="560" x2="140" y2="575.52802" />
              <polyline class="sysValue"            points="135,567.764 140,577.764 145,567.764 " />
            </g>
            <g>
              <line class="diaUnits"                x1="160" y1="560" x2="160" y2="575.52802" />
              <polyline class="diaUnits"            points="155,567.764 160,577.764 165,567.764 " />
            </g>
            <g>
              <line class="diaValue"                x1="180" y1="560" x2="180" y2="575.52802" />
              <polyline class="diaValue"            points="175,567.764 180,577.764 185,567.764 " />
            </g>
          </g>
          <g id="leftObs2" class="tree">
            <line class="arc"                       x1="200" y1="460" x2="200" y2="500" />
            <line class="arc"                       x1="200" y1="460" x2="240" y2="500" />
            <line class="arc"                       x1="200" y1="520" x2="200" y2="560" />
            <line class="arc"                       x1="200" y1="520" x2="220" y2="560" />
            <line class="arc"                       x1="240" y1="520" x2="240" y2="560" />
            <line class="arc"                       x1="240" y1="520" x2="260" y2="560" />
            <g>
              <line class="tpl"                     x1="200" y1="500" x2="200" y2="515.52802" />
              <polyline class="tpl"                 points="195,507.764 200,517.764 205,507.764 " />
            </g>
            <g>
              <line class="tpl"                     x1="240" y1="500" x2="240" y2="515.52802" />
              <polyline class="tpl"                 points="235,507.764 240,517.764 245,507.764 " />
            </g>
            <g>
              <line class="sysUnits"                x1="200" y1="560" x2="200" y2="575.52802" />
              <polyline class="sysUnits"            points="195,567.764 200,577.764 205,567.764 " />
            </g>
            <g>
              <line class="sysValue"                x1="220" y1="560" x2="220" y2="575.52802" />
              <polyline class="sysValue"            points="215,567.764 220,577.764 225,567.764 " />
            </g>
            <g>
              <line class="diaUnits"                x1="240" y1="560" x2="240" y2="575.52802" />
              <polyline class="diaUnits"            points="235,567.764 240,577.764 245,567.764 " />
            </g>
            <g>
              <line class="diaValue"                x1="260" y1="560" x2="260" y2="575.52802" />
              <polyline class="diaValue"            points="255,567.764 260,577.764 265,567.764 " />
            </g>
          </g>
        </g>
        <g id="rightText">
          <text class="node"                        x="420" y="040">:Patient-1234567</text>
          <text class="personName"                  x="440" y="060">personName:Аника</text>
          <text class="personID"                    x="440" y="080">personID:1234567</text>
          <text class="node"                        x="420" y="120">:Patient-1234567.Obs1</text>
          <text class="staticContent"               x="440" y="140">code:BloodPressure</text>
          <text class="personID"                    x="440" y="160">subjectID:1234567</text>
          <text class="node"                        x="440" y="180">related:</text>
          <text class="staticContent"               x="460" y="200">code:SystolicBloodPressure</text>
          <text class="node"                        x="460" y="220">quantity:</text>
          <text class="sysUnits"                    x="480" y="240">units:mmHg</text>
          <text class="sysValue"                    x="480" y="260">value:110</text>
          <text class="node"                        x="440" y="280">related:</text>
          <text class="staticContent"               x="460" y="300">code:DiastolicBloodPressure</text>
          <text class="node"                        x="460" y="320">quantity:</text>
          <text class="diaUnits"                    x="480" y="340">units:mmHg</text>
          <text class="diaValue"                    x="480" y="360">value:70</text>
          <text class="node"                        x="420" y="400">:Patient-1234567.Obs2</text>
          <text class="staticContent"               x="440" y="420">code:BloodPressure</text>
          <text class="personID"                    x="440" y="440">subjectID:1234567</text>
          <text class="node"                        x="440" y="460">related:</text>
          <text class="staticContent"               x="460" y="480">code:SystolicBloodPressure</text>
          <text class="node"                        x="460" y="500">quantity:</text>
          <text class="sysUnits"                    x="480" y="520">units:mmHg</text>
          <text class="sysValue"                    x="480" y="540">value:110</text>
          <text class="node"                        x="440" y="560">related:</text>
          <text class="staticContent"               x="460" y="580">code:DiastolicBloodPressure</text>
          <text class="node"                        x="460" y="600">quantity:</text>
          <text class="diaUnits"                    x="480" y="620">units:mmHg</text>
          <text class="diaValue"                    x="480" y="640">value:70</text>
        </g>
        <g id="rightTrees">
          <g id="rightObs1" class="tree">
            <line class="arc"                       x1="640" y1="120" x2="620" y2="160" />
            <line class="arc"                       x1="640" y1="120" x2="640" y2="160" />
            <line class="arc"                       x1="640" y1="120" x2="680" y2="160" />
            <line class="arc"                       x1="660" y1="180" x2="640" y2="220" />
            <line class="arc"                       x1="660" y1="180" x2="660" y2="220" />
            <line class="arc"                       x1="700" y1="180" x2="680" y2="220" />
            <line class="arc"                       x1="700" y1="180" x2="700" y2="220" />
            <line class="arc"                       x1="660" y1="240" x2="660" y2="280" />
            <line class="arc"                       x1="660" y1="240" x2="680" y2="280" />
            <line class="arc"                       x1="700" y1="240" x2="700" y2="280" />
            <line class="arc"                       x1="700" y1="240" x2="720" y2="280" />
            <g>
              <line class="staticContent"           x1="620" y1="160" x2="620" y2="175.528" />
              <polyline class="staticContent"       points="615,167.764 620,177.764 625,167.764 " />
            </g>
            <g>
              <line class="personID"                x1="640" y1="160" x2="640" y2="175.528" />
              <polyline class="personID"            points="635,167.764 640,177.764 645,167.764 " />
            </g>
            <g class="split">
              <line class="tpl"                     x1="680" y1="160" x2="660" y2="180" />
              <polyline class="tpl"                 points="665.117,167.812 661.581,178.419 672.188,174.883 " />
              <line class="tpl"                     x1="680" y1="160" x2="700" y2="180" />
              <polyline class="tpl"                 points="687.812,174.883 698.419,178.419 694.883,167.812  " />
            </g>
            <g>
              <line class="staticContent"           x1="640" y1="220" x2="640" y2="235.528" />
              <polyline class="staticContent"       points="635,227.764 640,237.764 645,227.764 " />
            </g>
            <g>
              <line class="tpl"                     x1="660" y1="220" x2="660" y2="235.528" />
              <polyline class="tpl"                 points="655,227.764 660,237.764 665,227.764 " />
            </g>
            <g>
              <line class="staticContent"           x1="680" y1="220" x2="680" y2="235.528" />
              <polyline class="staticContent"       points="675,227.764 680,237.764 685,227.764 " />
            </g>
            <g>
              <line class="sysUnits"                x1="660" y1="280" x2="660" y2="295.52802" />
              <polyline class="sysUnits"            points="655,287.764 660,297.764 665,287.764 " />
            </g>
            <g>
              <line class="sysValue"                x1="680" y1="280" x2="680" y2="295.52802" />
              <polyline class="sysValue"            points="675,287.764 680,297.764 685,287.764 " />
            </g>
            <g>
              <line class="diaUnits"                x1="700" y1="280" x2="700" y2="295.52802" />
              <polyline class="diaUnits"            points="695,287.764 700,297.764 705,287.764 " />
            </g>
            <g>
              <line class="diaValue"                x1="720" y1="280" x2="720" y2="295.52802" />
              <polyline class="diaValue"            points="715,287.764 720,297.764 725,287.764 " />
            </g>
            <g>
              <line class="tpl"                     x1="700" y1="220" x2="700" y2="235.528" />
              <polyline class="tpl"                 points="695,227.764 700,237.764 705,227.764 " />
            </g>
          </g>
          <g id="rightObs2" class="tree">
            <line class="arc"                       x1="640" y1="400" x2="620" y2="440" />
            <line class="arc"                       x1="640" y1="400" x2="640" y2="440" />
            <line class="arc"                       x1="640" y1="400" x2="680" y2="440" />
            <line class="arc"                       x1="660" y1="460" x2="640" y2="500" />
            <line class="arc"                       x1="660" y1="460" x2="660" y2="500" />
            <line class="arc"                       x1="700" y1="460" x2="680" y2="500" />
            <line class="arc"                       x1="700" y1="460" x2="700" y2="500" />
            <line class="arc"                       x1="660" y1="520" x2="660" y2="560" />
            <line class="arc"                       x1="660" y1="520" x2="680" y2="560" />
            <line class="arc"                       x1="700" y1="520" x2="700" y2="560" />
            <line class="arc"                       x1="700" y1="520" x2="720" y2="560" />
            <g>
              <line class="staticContent"           x1="620" y1="440" x2="620" y2="455.52802" />
              <polyline class="staticContent"       points="615,447.764 620,457.764 625,447.764 " />
            </g>
            <g>
              <line class="personID"                x1="640" y1="440" x2="640" y2="455.52802" />
              <polyline class="personID"            points="635,447.764 640,457.764 645,447.764 " />
            </g>
            <g class="split">
              <line class="tpl"                     x1="680" y1="440" x2="660" y2="460" />
              <polyline class="tpl"                 points="665.117,447.812 661.581,458.419 672.188,454.883 " />
              <line class="tpl"                     x1="680" y1="440" x2="700" y2="460" />
              <polyline class="tpl"                 points="687.812,454.883 698.419,458.419 694.883,447.812  " />
            </g>
            <g>
              <line class="staticContent"           x1="640" y1="500" x2="640" y2="515.52802" />
              <polyline class="staticContent"       points="635,507.764 640,517.764 645,507.764 " />
            </g>
            <g>
              <line class="tpl"                     x1="660" y1="500" x2="660" y2="515.52802" />
              <polyline class="tpl"                 points="655,507.764 660,517.764 665,507.764 " />
            </g>
            <g>
              <line class="staticContent"           x1="680" y1="500" x2="680" y2="515.52802" />
              <polyline class="staticContent"       points="675,507.764 680,517.764 685,507.764 " />
            </g>
            <g>
              <line class="sysUnits"                x1="660" y1="560" x2="660" y2="575.52802" />
              <polyline class="sysUnits"            points="655,567.764 660,577.764 665,567.764 " />
            </g>
            <g>
              <line class="sysValue"                x1="680" y1="560" x2="680" y2="575.52802" />
              <polyline class="sysValue"            points="675,567.764 680,577.764 685,567.764 " />
            </g>
            <g>
              <line class="diaUnits"                x1="700" y1="560" x2="700" y2="575.52802" />
              <polyline class="diaUnits"            points="695,567.764 700,577.764 705,567.764 " />
            </g>
            <g>
              <line class="diaValue"                x1="720" y1="560" x2="720" y2="575.52802" />
              <polyline class="diaValue"            points="715,567.764 720,577.764 725,567.764 " />
            </g>
            <g>
              <line class="tpl"                     x1="700" y1="500" x2="700" y2="515.52802" />
              <polyline class="tpl"                 points="695,507.764 700,517.764 705,507.764 " />
            </g>
          </g>
          <g id="rightPatient" class="tree">
            <line class="arc"                       x1="640" y1="20" x2="640" y2="60" />
            <line class="arc"                       x1="640" y1="20" x2="660" y2="60" />
            <g>
              <line class="personName"              x1="640" y1="60" x2="640" y2="75.527901" />
              <polyline class="personName"          points="635,67.7639 640,77.7639 645,67.7639 " />
            </g>
            <g>
              <line class="personID"                x1="660" y1="60" x2="660" y2="75.527901" />
              <polyline class="personID"            points="655,67.7639 660,77.7639 665,67.7639 " />
            </g>
          </g>
        </g>
      </defs>
    </svg>
  </head>

  <body>
    <div id="abstract">
      <p>
        This document motivates intuitive bridges between conventional clinical data representations and domain-specific ontologies that will be useful for knowledge/rule capture.
      </p>
    </div>

    <div>
      <h2 id="GenericObservations">Generic Observations</h2>
    <p>
      Most clinical data exchange denormalizes structured observations like blood pressure, APGAR, full blood count panel, etc into a constellation of observations.
      This encodes the semantics of the observation structure in conventions of terminology codes, e.g. <code>75367002| Blood pressure |</code> , <code>271649006| Systolic blood pressure |</code> and <code>271650006 | Diastolic blood pressure |</code>.
      Linkage between these are captured by some over-general predicates in the information model, e.g. <a href="http://www.hl7.org/FHIR/2015May/observation-definitions.html#Observation.related">fhir:related</a> or <a href="http://www.hl7.org/documentcenter/public_temp_402A2BAD-1C23-BA17-0C8B774BAD528AA6/standards/vocabulary/vocabulary_tables/infrastructure/vocabulary/vs_ActRelationshipType.html#ActRelationshipHasComponent">rim:COMP - has component</a>.
    </p>

    <p>
      RIM resuses Act and ActRelationships to capture these structures, providing a richer vocabulary of relationships captured in ActRelationships type codes.
      The body site or device for a blood pressure measurement are attached to the blood pressure observation by type codes like 
      Diagnostic processes like evidence and causality are captured in type codes <a href="http://www.hl7.org/documentcenter/public_temp_402A2BAD-1C23-BA17-0C8B774BAD528AA6/standards/vocabulary/vocabulary_tables/infrastructure/vocabulary/vs_ActRelationshipType.html#ActRelationshipProvidesEvidenceFor">EVID - provides evidence for</a> and <a href="http://www.hl7.org/documentcenter/public_temp_402A2BAD-1C23-BA17-0C8B774BAD528AA6/standards/vocabulary/vocabulary_tables/infrastructure/vocabulary/vs_ActRelationshipType.html#ActRelationshipIsEtiologyFor">CAUS - is etiology for</a>.
      FHIR has specialized relationships to capture some structural relationships like <a href="http://www.hl7.org/FHIR/2015May/observation-definitions.html#Observation.bodySite_x_">body site</a> or <a href="http://www.hl7.org/FHIR/2015May/observation-definitions.html#Observation.device">device</a>.
    </p>
    </div>

    <p>
      Even if we imposed a more complex information model for structured observations or treatment processes, there would always be some stuff for which there was no defined model.
      The semweb story "just invent some stuff and maybe it will get popular" isn't well suited to either the skills of the information wranglers or conventional paper-oriented clinical and legal processes.
    </p>

    <div>
      <h2 id="DomainModels">Domain models</h2>
      <div>
        <h3 id="whyDAMs">Why do we need domain models?</h3>
        <p>
          Domain models will likely be more principled in their design and will definitely be more intuitive the physical models involving constellations of observations.
          A class and relationship hierarchy such as that implemented in ActRelationship type codes will be more simply expressed in an RDF ontology and will leverage existing RDF tooling for model and example verification.          
        </p>
      </div>

      <div>
        <h3 id="availableDAMs">Available DAMs</h3>
        <p>
          Projects like CIMI engage clinicians in the development of intuitive domain models, e.g. a blood pressure and a structure with a measurement of a systolic and distolic pressure, and maybe some other stuff like posture or device.
          Here are a few CIMI models:
        </p>

        <ul>
          <li><a href="https://openehr.atlassian.net/wiki/display/CIMI/CIMI+CLINICAL_DATA_GROUP+Model?preview=/1802241/1933330/BP_archetype.png">blood pressure</a></li>
          <li><a href="http://www.w3.org/2015/Talks/0203-11179-egp/#(6)">APGAR</a></li>
          <li><a href="https://openehr.atlassian.net/wiki/display/CIMI/CIMI+CLINICAL_DATA_GROUP+Model">full blood count panel</a></li>
        </ul>
      </div>

      <div>
        <h3 id="DAMasOntology">DAM as Ontology</h3>
        <p>
          Ideally, development of little DAMs would include identifying all of the intersections between them, creating a more comprehensive DAM, and ontology of clinical artifacts.
          The body mass used in an estimated glomerular filtration rate is the same as the body mass used in a body mass index.
          A useful clinical ontology in RDF would capture that by reusing the same identifiers wherever the same concept was reused.
        </p>
      </div>
    </div>

    <div>
      <h2 id="Mappings">Mappings</h2>
      <div>
        <h3 id="whyMappings">Why do we need mappings?</h3>
        <p>
          
        </p>
        <ul>
          <li>Definitions for physical representations — presuming the DAM has intuitive and useful semantics mapping a physical model to a logical model provides clear guidelines for implementors who need to work with the corresponding physical models. These take the place of implementation guidelines or instance diagrams.</li>
          <li>Duplication detection — if two domain models map to the same physical model, either the models are incomplete or they duplicate each other. This will be tempered by the fact that any models that share components will necessarily map to the same physical model.</li>
          <li>Data/query transformation — mapping between a physical model and a logical model provides users of the logical model, for instance, someone writing clinical decisions support rules, access to working clinical data. Mappings between a logical model and two or more physical models enables mappings between those physical models.</li>
        </ul>
      </div>

      <div>
        <h3 id="mappingMechanism">Mapping mechanism?</h3>
        <p>
          As the models are described as ShEx schemas, the mappings between them are captured as shared "variables" in a <span class="preprocessor">%map:{ %}</span> extension.
          These variables are given full URLs which enables trivial disambiguation, as well as leveraging standard prefix conventions for easier lexical categorization.
        </p>
      </div>

      <div>
        <h3 id="bpexample">Blood pressure example</h3>
        <div>
          <h4 id="BPDAM">BP DAM</h4>
          <div>
            <h5 id="BPunitsDAM">BP units DAM</h5>
            <pre class="example">
<span class="variable-name">&lt;BPunitsDAM&gt;</span> {
    <span class="variable-name">:systolic</span> {
        <span class="type">:</span><span class="constant">value</span> <span class="type">xsd:</span><span class="constant">float</span> <span class="preprocessor">%map:{ bp:sysVal %}</span>,
        <span class="type">:</span><span class="constant">units</span> <span class="type">xsd:</span><span class="constant">string</span> <span class="preprocessor">%map:{ bp:sysUnits %}</span>
    },
    <span class="variable-name">:diastolic</span> {
        <span class="type">:</span><span class="constant">value</span> <span class="type">xsd:</span><span class="constant">float</span> <span class="preprocessor">%map:{ bp:diaVal %}</span>,
        <span class="type">:</span><span class="constant">units</span> <span class="type">xsd:</span><span class="constant">string</span> <span class="preprocessor">%map:{ bp:diaUnits %}</span>
    }
}
            </pre>
          </div>

          <div>
            <h5 id="BPnormalizedDAM">BP normalized DAM</h5>
            <pre class="example">
<span class="variable-name">&lt;BPnormalizeDAM&gt;</span> {
    <span class="keyword">a</span> (<span class="type">:</span><span class="constant">CanonicalBloodPressure</span>),
    <span class="type">:</span><span class="constant">systolicBPmmHg</span> <span class="type">xsd:</span><span class="constant">float</span> <span class="preprocessor">%map:{ cast(bp:sysVal, bp:sysUnits, "mmHg") %}</span>,
    <span class="type">:</span><span class="constant">diastolicBPmmHg</span> <span class="type">xsd:</span><span class="constant">float</span> <span class="preprocessor">%map:{ cast(bp:diaUnits, bp:diaUnits, "mmHg") %}</span>
}
            </pre>
          </div>
        </div>

        <div>
          <h4 id="BPFHIR">BP FHIR</h4>
            <pre class="example">
<span class="variable-name">&lt;BPfhir&gt;</span> {
    <span class="keyword">a</span> (<span class="type">fhir:</span><span class="constant">Observation</span>)<span class="keyword">?</span>,
    <span class="variable-name">fhir:coding</span> { <span class="type">fhir:</span><span class="constant">code</span> (<span class="type">sct:</span><span class="constant">Blood_Pressure</span>) },
    <span class="variable-name">fhir:related</span> { <span class="type">fhir:</span><span class="constant">type</span> (<span class="string">"has-component"</span>), <span class="type">fhir:</span><span class="constant">target</span> <span class="variable-name">@&lt;sysBP&gt;</span> },
    <span class="variable-name">fhir:related</span> { <span class="type">fhir:</span><span class="constant">type</span> (<span class="string">"has-component"</span>), <span class="type">fhir:</span><span class="constant">target</span> <span class="variable-name">@&lt;diaBP&gt;</span> }
}
<span class="variable-name">&lt;sysBP&gt;</span> {
    <span class="keyword">a</span> (<span class="type">fhir:</span><span class="constant">Observation</span>)<span class="keyword">?</span>,
    <span class="variable-name">fhir:coding</span> { <span class="type">fhir:</span><span class="constant">code</span> (<span class="type">sct:</span><span class="constant">Systolic_Blood_Pressure</span>) },
    <span class="variable-name">fhir:valueQuantity</span> {
        <span class="keyword">a</span> (<span class="type">fhir:</span><span class="constant">Quantity</span>)<span class="keyword">?</span>,
        <span class="type">fhir:</span><span class="constant">value</span> <span class="type">xsd:</span><span class="constant">float</span> <span class="preprocessor">%map:{ bp:sysVal %}</span>,
        <span class="type">fhir:</span><span class="constant">units</span> <span class="type">xsd:</span><span class="constant">string</span> <span class="preprocessor">%map:{ bp:sysUnits %}</span>
    },
}
<span class="variable-name">&lt;diaBP&gt;</span> {
    <span class="keyword">a</span> (<span class="type">fhir:</span><span class="constant">Observation</span>)<span class="keyword">?</span>,
    <span class="variable-name">fhir:coding</span> { <span class="type">fhir:</span><span class="constant">code</span> (<span class="type">sct:</span><span class="constant">Diastolic_Blood_Pressure</span>) },
    <span class="variable-name">fhir:valueQuantity</span> {
        <span class="keyword">a</span> (<span class="type">fhir:</span><span class="constant">Quantity</span>)<span class="keyword">?</span>,
        <span class="type">fhir:</span><span class="constant">value</span> <span class="type">xsd:</span><span class="constant">float</span> <span class="preprocessor">%map:{ bp:diaVal %}</span>,
        <span class="type">fhir:</span><span class="constant">units</span> <span class="type">xsd:</span><span class="constant">string</span> <span class="preprocessor">%map:{ bp:diaUnits %}</span>
    },
}
</pre>
</div>
</div>
    </div>
    <div>
      <h2 id="Mechanism">Mechanism</h2>
      <ol>
        <li>Validate instance document with respect to source schema (say <a href="#BPFHIR">BP FHIR</a>)<br/>
        produces variable bindings</li>
        <li>Invoke <code>generate</code> with the start shape of the target schema (say <a href="BPDAM">BP DAM</a>) and a fresh bnode</li>
        <li>The shape is <code>S</code> and the current subject is <code>B</code>.</li>
        <li>for each property <code>P</code>:
        <ol>
          <li>if the property is a reference to shape <code>R</code>, create a fresh bnode <code>Bchild</code>, assert <code>(B, P, Bchild)</code>, invoke <code>generate</code> with the shape <code>R</code> and the subject <code>Bchild</code>.
          </li>
          <li>if the element is a leaf node (scalar value)<br/>
          if the element has a variable and the variable is bound to <code>V</code>, assert <code>(B, P, V)</code></li>
        </ol>
        </li>
        <li>The resulting graph of assertions should validate as the target schema.</li>
      </ol>

      <svg version="1.1" id="textmapBox"
           viewBox="0 18 727 625" style="width: 50%"
           xmlns="http://www.w3.org/2000/svg"
           xmlns:xlink="http://www.w3.org/1999/xlink" >
        <g>
          <use xlink:href="#leftText"               x="0" y="0" width="687" height="625" />
          <use xlink:href="#leftTrees"              x="0" y="0" width="687" height="625"
                                                    transform="translate(100, -50)" />
          <use xlink:href="#textmapArrows"          x="0" y="0" width="687" height="625" />
          <use xlink:href="#rightText"              x="0" y="0" width="687" height="625" />
          <use xlink:href="#rightTrees"             x="0" y="0" width="687" height="625" />
        </g>
        <g id="legend"                              transform="translate(0, 410)">
          <text style="fill:#000000;"               x="80" y="60">Legend:</text>
          <g id="legend_properties"                 transform="matrix(0,-1,1,0,0.24364069,190.27599)">
            <line class="arc"                       x1="84.890511" y1="65.026848" x2="64.929245" y2="104.94937" />
            <line class="arc"                       x1="84.890511" y1="65.026848" x2="84.890511" y2="104.94937" />
            <line class="arc"                       x1="84.890511" y1="65.026848" x2="124.81301" y2="104.94937" />
          </g>
          <g id="legend_matchedTriples"             transform="matrix(0,-1,1,0,-79.262542,276.66353)">
            <g class="tpl"                          transform="matrix(0.99806298,0,0,0.99806298,-181.70062,-44.941907)">
              <line class="staticContent"           x1="260" y1="210" x2="260" y2="225.528" />
              <polyline class="staticContent"       points="255,217.764 260,227.764 265,217.764 " />
            </g>
            <g class="tpl"                          transform="matrix(0.99806298,0,0,0.99806298,-188.34818,-44.941907)">
              <line class="personID"                x1="280" y1="210" x2="280" y2="225.528" />
              <polyline class="personID"            points="275,217.764 280,227.764 285,217.764 " />
            </g>
            <g class="tpl"                          transform="matrix(0.99806298,0,0,0.99806298,-202.75118,-44.941907)">
              <line                                 x1="320" y1="210" x2="303.16199" y2="226.838" />
              <polyline                             points="305.117,217.812 301.581,228.419 312.188,224.883 " />
            </g>
            <g class="tpl"
               transform="matrix(0.99806298,0,0,0.99806298,-202.75118,-44.941907)">
              <line                                 x1="320" y1="210" x2="336.83801" y2="226.838" />
              <polyline                             points="327.812,224.883 338.419,228.419 334.883,217.812 " />
            </g>
          </g>
          <text style="fill:#000000;"               x="128.54137" y="138.3644"
                transform="matrix(0.55396191,0,0,0.55396191,40,16.442852)">properties</text>
          <text style="fill:#000000;"               x="128.54137" y="158.3644"
                transform="matrix(0.55396191,0,0,0.55396191,40,16.442852)">in schema</text>
          <text style="fill:#000000;"               x="129.94466" y="270.27365"
                transform="matrix(0.55396191,0,0,0.55396191,40,16.442852)">matched or</text>
          <text style="fill:#000000;"               x="129.94466" y="290.27365"
                transform="matrix(0.55396191,0,0,0.55396191,40,16.442852)">implied triples</text>
        </g>
      </svg>
      <p>
        This can be viewed as mappig between two trees:
      </p>
      <div class="namespace">
        <div style="float:left;">
          <ul>
            <li class="patient2patient ll">patient record <span class="p1234567">:p1234567</span> ⇨ <span class="Patient-1234567">:Patient-1234567</span></li>
            <li class="patient2obs1 ll">blood pressure <span class="patientObs1 ll">reading 1</span> ⇨ <span class="Patient-1234567_Obs1">:Patient-1234567.Obs1</span></li>
            <li class="patient2obs2 ll">blood pressure <span class="patientObs2 ll">reading 2</span> ⇨ <span class="Patient-1234567_Obs2">:Patient-1234567.Obs2</span></li>
          </ul>
        </div>
        <svg version="1.1" id="treemapBox"
             viewBox="47 17 354 262" style="float:left; width:30%;"
             xmlns="http://www.w3.org/2000/svg"
             xmlns:xlink="http://www.w3.org/1999/xlink"
             >
          <g id="treemap">
            <!--use xlink:href="#leftTrees" class="p1234567 ll"
                 transform="translate(-66.475428,-332.37718)" / -->
            <use xlink:href="#leftPatient" class="p1234567 ll"
                 transform="translate(-66.475428,-332.37718)" />
            <use xlink:href="#leftSplit" class="p1234567 ll"
                 transform="translate(-66.475428,-332.37718)" />
            <use xlink:href="#leftObs1" class="patientObs1 ll"
                 transform="translate(-66.475428,-332.37718)" />
            <use xlink:href="#leftObs2" class="patientObs2 ll"
                 transform="translate(-66.475428,-332.37718)" />

            <use xlink:href="#rightPatient" class="Patient-1234567"
                 transform="translate(-446.11667,-1.2437907)" />
            <use xlink:href="#rightObs1" class="Patient-1234567_Obs1"
                 transform="translate(-325.76608,-71.565469)" />
            <use xlink:href="#rightObs2" class="Patient-1234567_Obs2"
                 transform="translate(-406.93726,-301.12002)" />
            <g id="treemapArrows"                   transform="translate(-256.84278,-294.1565)">
              <g id="patientArrow" class="patient2patient ll"
                 transform="matrix(0.99806298,0,0,0.99806298,211.76945,222.62011)">
                <line                               x1="120" y1="140" x2="226.64101" y2="95.5662" />
                <polygon class="cover"              points="228.564,100.182 235.872,91.7201 224.718,90.9508 " />
                <polygon class="arrowhead"          points="228.564,100.182 235.872,91.7201 224.718,90.9508 " />
              </g>
              <g id="obs1Arrow" class="patient2obs1 ll"
                 transform="matrix(0.99806298,0,0,0.99806298,211.76945,222.62011)">
                <line                               x1="140" y1="200" x2="346.39899" y2="124.946" />
                <polygon class="cover"              points="348.108,129.645 355.797,121.528 344.69,120.247 " />
                <polygon class="arrowhead"          points="348.108,129.645 355.797,121.528 344.69,120.247 "/>
              </g>
              <g id="obs2Arrow" class="patient2obs2 ll"
                 transform="matrix(0.99806298,0,0,0.99806298,211.76945,222.62011)">
                <line                               x1="180" y1="200" x2="266.138" y2="174.159" />
                <polygon class="cover"              points="267.575,178.948 275.716,171.285 264.701,169.369 " />
                <polygon class="arrowhead"          points="267.575,178.948 275.716,171.285 264.701,169.369 " />
              </g>
            </g>
          </g>
        </svg>
        <div style="clear:both;"/>
      </div>
    <script type="text/javascript">
      <!--
          // Make copies of referents so we can apply the behind class.
          $("#treemap use").each(function (ord, elt) {         // use referents
            elt = $(elt);                              
            var referent = elt.attr("xlink:href");
            $(referent).clone().
              attr("id", referent.substr(1)+"copy").
              attr("transform", elt.attr("transform")).
              attr("class", elt.attr("class")).addClass("behind").
              insertBefore(elt);
          });
          $("#treemapArrows line").
          add("#treemapArrows .arrowhead").each(function (ord, elt) { // arrows
            elt = $(elt);
            $(elt).clone().
              attr("transform", elt.attr("transform")). // none at present, but...
              attr("class", elt.attr("class")).addClass("behind").
              insertBefore(elt);
          });
          prepareHighlight(["p1234567", "patientObs1", "patientObs2", "Patient-1234567", "Patient-1234567_Obs1", "Patient-1234567_Obs2", "patient2patient", "patient2obs1", "patient2obs2"], "hl", "ll");
      -->
    </script>
    </div>

    <div>
      <h2 id="Issues">Issues</h2>
      <ul>
        <li>
          <em>glue between heads and bodies</em>
          <p>
            In principle, shared variables are enough to associated rule heads with rule bodies.
            We need to test this with compositions in which a DAM uses variables bound in multiple physical models (e.g. a body mass in a BMI) and multiple DAMs used the same variables (e.g. BMI and EGFR).
          </p>
        </li>
        <li>
          <em>n-ary predicates</em>
          <p>
            Mapping directed, labeled graphs to familiar n-ary predicates for use in e.g. Quick (CQL).
          </p>
        </li>
      </ul>
    </div>

    <address>
      ideas from Claude Nanjo and Mohammad Hekmatnejad:<br/>
      edited by: <a href="http://www.w3.org/People/Eric/">Eric Prud'hommeaux</a>
      $id$
    </address>
  </body>
</html>
